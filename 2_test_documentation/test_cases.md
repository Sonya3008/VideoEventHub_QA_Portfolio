**TC-01. Получение live-видео с камеры**

Предусловия:

- Камера добавлена в систему

- Камера активна

Шаги:

1. Подключиться к камере
2. Открыть live-просмотр

Ожидаемый результат:
Видео отображается без задержек более 5 секунд


**TC-02. Отсутствие события при активном видеопотоке**

Предусловия:

- Камера активна

- Видеопоток доступен

- События включены в настройках камеры

Шаги:

1. Сымитировать событие (например движение)
2. Проверить отображение события в UI
3. Проверить сохранение события в БД
4. Проверить API-ответ

Ожидаемый результат:

- Событие отображается в UI

- Событие сохраняется в БД

- Событие связано с камерой и временным интервалом видео

**API-проверка:**

Endpoint:
[POST /api/events](url)

Тело запроса:

{
  "camera_id": 1,
  "event_type": "motion",
  "timestamp": "2026-02-10T12:30:00Z"
}

Ожидаемый ответ:

- HTTP 201

- event_id в теле ответа

**SQL-проверка:**
  SELECT * 
  FROM events 
  WHERE camera_id = 1 
  ORDER BY timestamp DESC;


**ТС-03. Восстановление видеопотока после сетевого обрыва**

Предусловия:

- Камера добавлена в систему

- Камера активна

- Live-видео отображается

Шаги:

1. Отключить сетевое соединение камеры
2. Наблюдать статус камеры в системе
3. Подождать 30 секунд
4. Восстановить сетевое соединение
5. Проверить доступность live-видео
6. Проверить логи и события системы

Ожидаемый результат:

- Статус камеры меняется на «Нет сигнала»

- Ошибка обрыва видеопотока логируется

- После восстановления сети система автоматически переподключается

- Live-видео становится доступным без перезапуска сервиса

- Потеря видеопотока фиксируется в системе

**SQL-проверка:**
Статус камеры:

SELECT * 
FROM camera_status_history 
WHERE camera_id = 1 
ORDER BY created_at DESC;

Логирование ошибок:

SELECT * 
FROM system_logs 
WHERE message LIKE '%stream lost%' 
ORDER BY created_at DESC;
